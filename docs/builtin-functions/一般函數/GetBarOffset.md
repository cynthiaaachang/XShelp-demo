# GetBarOffset – （內建函數） <kbd>一般函數</kbd>

## 語法

> 依傳入的交易日的日期取得相對K棒位置。  
> **回傳數值=GetBarOffset(日期)**  
> **回傳數值=GetBarOffset(日期，時間)**  
> 傳入二個參數：  
> - 第一個參數是交易日的日期，格式為YYYYMMDD。  
> - 第二個參數是時間，格式為HHMMSS，第二個參數可以不用傳。  

---

## 說明

依傳入的交易日的日期取得相對K棒位置。

可以傳入兩個參數：
- 第一個參數是日期，格式為YYYYMMDD。
- 第二個參數是時間，格式為HHMMSS，第二個參數可以不用傳。

當回傳值為0時，表示傳入日期/時間 ≧K棒日期/時間。
當回傳值為1時，代表目前K棒的前一根K棒日期/時間為傳入日期/時間。

範例：

```pascal
value1 = GetBarOffset(20150831); //取得20150831這根K棒的相對位置
value2 = High[value1]; //取得20150831當天的最高價
plot1(value2); //繪出20150831最高價的水平線
```

注意，當無傳入日期這根K棒時，會往前找到最接近的一根。例如：20150829、20150830是非交易日，所以會往前找到20150828這根K棒。也就是說GetBarOffset(20150828)、GetBarOffset(20150829)、GetBarOffset(20150830)的回傳值會是相等的。
