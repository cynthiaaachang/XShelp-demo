# blackscholesmodel – （系統函數） <kbd>邏輯判斷</kbd>

## 語法

> 利用BlackScholes選擇權評價模型計算理論價及Greeks  
> **回傳數值=BlackScholesModel (買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,波動率,輸出理論價,輸出Delta,輸出Gamma,輸出Vega,輸出Theta,輸出Rho)**  
> 傳入十三個參數:  
> - 第一個參數是買賣權，C表買權、P表賣權。  
> - 第二個參數是標的價格。  
> - 第三個參數是履約價。  
> - 第四個參數是到期天數。  
> - 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。  
> - 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。  
> - 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。  
> **- 第八個參數為傳址參數，會回傳計算完的選擇權理論價。**  
> **- 第九個參數為傳址參數，會回傳計算完的選擇權Delta。**  
> **- 第十個參數為傳址參數，會回傳計算完的選擇權Gamma。**  
> **- 第十一個參數為傳址參數，會回傳計算完的選擇權Vega。**  
> **- 第十二個參數為傳址參數，會回傳計算完的選擇權Theta。**  
> **- 第十三個參數為傳址參數，會回傳計算完的選擇權Rho。**  

---

## 說明

BS選擇權定價模型為諾貝爾經濟學獎得主Robert Merton和Myron Scholes於1973所發表。依據下列六個參數決定選擇權的理論價：標的價格、履約價、到期天數、無風險利率、持有成本、波動率。其中只有履約價和到期天數是由合約所規定，其餘參數皆會隨市場狀況而變動。


持有成本會因標的商品的不同而異：
- 股票選擇權的持有成本為無風險利率（r）-股票殖利率
- 期貨選擇權的持有成本為0
- 外匯選擇權的持有成本為無風險利率（r）-外國無風險利率


這個函數可以依照使用者傳入的參數，計算選擇權的理論價、Delta、Gamma、Vega、Theta及Rho。


範例：

```pascal
value1 = BlackScholesModel("C",8800,9000,20,2,0,25,value2,value3,value4,value5,value6,value7);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的理論價
plot1(value2, "理論價");   
plot2(value3, "Delta");   
plot3(value4, "Gamma");   
plot4(value5, "Vega");   
plot5(value6, "Theta");   
plot6(value7, "Rho");   
```
